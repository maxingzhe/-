<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no"/>
    <link rel="stylesheet" href="css/index.css">
</head>
<body>
    <div id="wrap">
        <header class="header">
            <div class="ding">
                <div class="search">
                    <div class="left">
                        <a href="JavaScript:;">
                            <span>狗狗</span>
                            <span>|</span>
                            <span>重庆</span>
                            <i></i>
                        </a>
                    </div>
                    <div class="center">
                        <a href="JavaScript:;">
                            <input type="text" placeholder="搜索商品和品牌">
                            <span class="icon"></span>
                        </a>
                    </div>
                    <a href="JavaScript:;" class="right">
                        <img src="img/mydope.png">
                    </a>
                </div>
            </div>
            <div class="nav">
                <ul class="list">
                    <li>
                        <a href="JavaScript:;">
                            <span style="color: #459d36">首页</span>
                            <i class="smallGreen"></i>
                        </a>
                    </li>
                    <li>
                        <a href="JavaScript:;">
                            <img src="img/tab.jpg.jpg">
                            <i></i>
                        </a>
                    </li>
                    <li>
                        <a href="JavaScript:;">
                            <span>清凉馆</span>
                            <i></i>
                        </a>
                    </li>
                    <li>
                        <a href="JavaScript:;">
                            <span>狗狗主粮</span>
                            <i></i>
                        </a>
                    </li>
                    <li>
                        <a href="JavaScript:;">
                            <span>零食</span>
                            <i></i>
                        </a>
                    </li>
                    <li>
                        <a href="JavaScript:;">
                            <span>医疗保健</span>
                            <i></i>
                        </a>
                    </li>
                    <li>
                        <a href="JavaScript:;">
                            <span>玩具</span>
                            <i></i>
                        </a>
                    </li>
                    <li>
                        <a href="JavaScript:;">
                            <span>外出</span>
                            <i></i>
                        </a>
                    </li>
                </ul>
            </div>
        </header>
        <div class="banner">
            <ul class="list">
                <li>
                    <a href="JavaScript:;">
                        <img src="img/1.jpg.jpg" class="bannerlun">
                    </a>
                </li>
                <li>
                    <a href="JavaScript:;">
                        <img src="img/2.jpg.jpg" class="bannerlun">
                    </a>
                </li>
                <li>
                    <a href="JavaScript:;">
                        <img src="img/3.jpg.jpg" class="bannerlun">
                    </a>
                </li>
                <li>
                    <a href="JavaScript:;">
                        <img src="img/4.jpg.jpg" class="bannerlun">
                    </a>
                </li>
                <li>
                    <a href="JavaScript:;">
                        <img src="img/5.jpg.jpg" class="bannerlun">
                    </a>
                </li>
                <li>
                    <a href="JavaScript:;">
                        <img src="img/6.jpg.jpg" class="bannerlun">
                    </a>
                </li>
                <li>
                    <a href="JavaScript:;">
                        <img src="img/7.jpg.jpg" class="bannerlun">
                    </a>
                </li>
                <li>
                    <a href="JavaScript:;">
                        <img src="img/8.jpg.jpg" class="bannerlun">
                    </a>
                </li>
            </ul>
            <!--小圆点-->
            <div class="banIcons">
                <span class="active"></span>
                <span></span>
                <span></span>
                <span></span>
                <span></span>
                <span></span>
                <span></span>
                <span></span>
            </div>
        </div>
        <div class="bannerdown">
            <ul class="downlist">
                <li>
                    <a href="JavaScript:;">
                        <img src="img/9.jpg.jpg">
                    </a>
                </li>
                <li>
                    <a href="JavaScript:;">
                        <img src="img/10.jpg.jpg">
                    </a>
                </li>
                <li>
                    <a href="JavaScript:;">
                        <img src="img/11.jpg.jpg">
                    </a>
                </li>
            </ul>
        </div>
        <div class="box">
            <ul class="box_list">
                <li>
                    <a href="JavaScript:;">
                        <img src="img/12.jpg.png">
                    </a>
                </li>
                <li>
                    <a href="JavaScript:;">
                        <img src="img/13.jpg.png">
                    </a>
                </li>
                <li>
                    <a href="JavaScript:;">
                        <img src="img/14.jpg.png">
                    </a>
                </li>
                <li>
                    <a href="JavaScript:;">
                        <img src="img/15.jpg.png">
                    </a>
                </li>
                <li>
                    <a href="JavaScript:;">
                        <img src="img/16.jpg.png">
                    </a>
                </li>
                <li>
                    <a href="JavaScript:;">
                        <img src="img/17.jpg.png">
                    </a>
                </li>
                <li>
                    <a href="JavaScript:;">
                        <img src="img/18.jpg.png">
                    </a>
                </li>
                <li>
                    <a href="JavaScript:;">
                        <img src="img/19.jpg.png">
                    </a>
                </li>
                <li>
                    <a href="JavaScript:;">
                        <img src="img/20.jpg.png">
                    </a>
                </li>
                <li>
                    <a href="JavaScript:;">
                        <img src="img/21.jpg.png">
                    </a>
                </li>
            </ul>
        </div>
        <div class="content">
            <div class="smallzhu">
                <a href="JavaScript:;">
                    <img src="img/22.jpg.jpg">
                </a>
            </div>
            <div class="jianmian">
                <div class="left">
                    <a href="JavaScript:;">
                        <img src="img/23.jpg.jpg" class="one">
                    </a>
                </div>
                <ul class="right">
                    <li>
                        <a href="JavaScript:;">
                            <img src="img/24.jpg.jpg" class="two">
                        </a>
                    </li>
                    <li>
                        <a href="JavaScript:;">
                            <img src="img/25.jpg.jpg" class="two">
                        </a>
                    </li>
                </ul>
            </div>
            <div class="meiri">
                <div class="one">
                    <img src="img/26.jpg.png">
                </div>
                <div class="two">本场结束</div>
                <div class="three">18:00</div>
                <div class="four">
                    <img src="img/27.jpg.png">
                </div>
            </div>
            <div class="tuo_two">
                <ul class="list_two">
                    <li>
                        <img src="img/28.jpg.jpg">
                        <span>￥2.9</span>
                        <span>省100</span>
                    </li>
                    <li>
                        <img src="img/29.jpg.jpg">
                        <span>￥2.9</span>
                        <span>省100</span>
                    </li>
                    <li>
                        <img src="img/30.jpg.jpg">
                        <span>￥2.9</span>
                        <span>省100</span>
                    </li>
                    <li>
                        <img src="img/31.jpg.jpg">
                        <span>￥2.9</span>
                        <span>省100</span>
                    </li>
                    <li>
                        <img src="img/32.jpg.jpg">
                        <span>￥2.9</span>
                        <span>省100</span>
                    </li>
                    <li>
                        <img src="img/33.jpg.jpg">
                        <span>￥2.9</span>
                        <span>省100</span>
                    </li>
                    <li>
                        <img src="img/34.jpg.jpg">
                        <span>￥2.9</span>
                        <span>省100</span>
                    </li>
                    <li>
                        <img src="img/35.jpg.jpg">
                        <span>￥2.9</span>
                        <span>省100</span>
                    </li>
                </ul>
            </div>
        </div>
    </div>
    <!--滚动条-->
    <div id="scrollBar"></div>
</body>
<script type="text/javascript" src="js/transform.js"></script>
<script type="text/javascript">
    document.addEventListener('touchstart',function (event) {
        event.preventDefault();
    })
    !(function(){
        var aNodes = document.querySelectorAll('a');
        for(var i=0;i<aNodes.length;i++){
            aNodes[i].addEventListener('touchstart',function(){
                window.location.href = this.href;
            });
        };
    })();
    (function(){
        var width = document.documentElement.clientWidth;
        var styleNode = document.createElement('style');
        styleNode.innerHTML = 'html{font-size: '+ width/16 +'px;!important;}';
        document.head.appendChild(styleNode);
    })()
//  导航
    function navTap() {
        <!--导航获取-->
        var navWrap = document.querySelector('#wrap .header .nav');
        var navList = document.querySelector('#wrap .header .nav .list');
//      定义元素初始位置
        var eleX = 0;
//      定义手指初始位置
        var startX = 0;
        //加速
        var s1 = 0;
        var t1 = 0;
        var s2 = 0;
        var t2 = 0;
        var disValue = 0;
        var disTime = 1; //非0数字
        var speed = 0;
        navWrap.addEventListener('touchstart',function (event) {
            var touch = event.changedTouches[0];
            navList.style.transition = 'none';
//            元素初始位置
            eleX = transformCss(navList,'translateX')
//            手指的初始位置
            startX = touch.clientX;
//            加速起始的位置
            s1 = eleX;
            t1 = new Date().getTime();
            speed = 0;
        });
        navWrap.addEventListener('touchmove',function (event) {
            var touch = event.changedTouches[0];
//            手指的结束位置
            var endX = touch.clientX;
//            手指距离差
            var disX = endX - startX;
            var translateX = disX+eleX;
            if(translateX > 0){
                translateX = 0;
            }else if(translateX < document.documentElement.clientWidth-navList.offsetWidth){
                translateX = document.documentElement.clientWidth-navList.offsetWidth;
            }
//            确定元素位置
            transformCss(navList,'translateX',translateX)
//            加速结束的位置
            s2 = translateX;
            t2 = new Date().getTime();
            disValue = s2 - s1;
            disTime = t2 - t1;
        })
//        加速
        navWrap.addEventListener('touchend',function () {
            speed = disValue / disTime;
            //元素最终位置 （加速） = touchmove 产生是位移值 + speed 产生的距离
            var target = transformCss(navList,'translateX') + speed*100;
            if(target > 0){
                target = 0;
            }else if(target < document.documentElement.clientWidth-navList.offsetWidth){
                target = document.documentElement.clientWidth-navList.offsetWidth;
            }
            navList.style.transition = '1s';
            transformCss(navList,'translateX',target);
        })
    }
    navTap();

//    轮播
    banner();
    function banner(){
        //获取元素
        var wrap = document.querySelector('#wrap .banner')
        var list = document.querySelector('#wrap .banner .list');

        list.innerHTML += list.innerHTML;

        var liNodes = document.querySelectorAll('#wrap .banner .list li');
        var spanNodes = document.querySelectorAll('#wrap .banner .banIcons > span');

        //布局样式区域
        var styleNode = document.createElement('style');
        styleNode.innerHTML = '#wrap .banner{height: '+ liNodes[0].offsetHeight +'px;}';
        styleNode.innerHTML += '#wrap .banner .list{width: '+ liNodes.length +'00%;}';
        styleNode.innerHTML += '#wrap .banner .list li{width: '+ 100/liNodes.length +'%;}'
        document.head.appendChild(styleNode)
        //上一次的下标
        var lastIndex = 0;
        //当前下标
        var nowIndex = 0;
        //滑屏
        //定义元素与手指初始位置
        var eleX = 0;
        var startX = 0;

        //防抖动需要变量
        var startY = 0;
        //是否是 第一次 touchmove
        var isFirst = true;
        // 非第一次的 touchmove 是否执行
        var isX = true;

        //图片索引下标
        var now = 0;

        //定时器
        var timer = null;

        wrap.addEventListener('touchstart',function(event){
            //清除过渡
            list.style.transition = 'none';

            //清除定时器
            clearInterval(timer);

            //无缝
            if(now == 0){
                now = spanNodes.length;
            }else if(now == liNodes.length-1){
                now = spanNodes.length-1;
            };
            //真正的跳转  写入
            transformCss(list,'translateX',-now*document.documentElement.clientWidth)
            var touch = event.changedTouches[0];
            //元素初始位置  -- 读取
            eleX = transformCss(list,'translateX')

            //手指初始位置
            startX = touch.clientX;
            startY = touch.clientY;

            //重置：清除上一次操作结果
            isFirst = true;
            isX = true;
        });
        wrap.addEventListener('touchmove',function(event){
            var touch = event.changedTouches[0];

            //禁止非第一次 touchmove 逻辑
            if(!isX){
                return;
            };

            //手指结束位置
            var endX = touch.clientX;
            var endY = touch.clientY;
            //手指距离差
            var disX = endX - startX;
            var disY = endY - startY;

            //防抖动
            // 如果是第一次 touchmove , disY > disX === 禁止水平方向逻辑
            if(isFirst){
                isFirst = false;
                if(Math.abs(disY) > Math.abs(disX)){
                    //禁止水平方向逻辑 ， x方向的逻辑
                    isX = false;
                    return; //第一次 touchmove,水平方向逻辑
                };
            }
            //确定元素最终位置 -- 写入
            transformCss(list,'translateX',disX + eleX)


        });
        //跳转动作
        wrap.addEventListener('touchend',function(){
            //过渡
            list.style.transition = '1s';
            //list 元素 的 left值  -- 读取
            var left = transformCss(list,'translateX')

            now = Math.round(-left/document.documentElement.clientWidth);

            //范围限定
            if(now < 0){
                now = 0
            }else if(now > liNodes.length-1){
                now = liNodes.length-1
            }
            //最终元素位置left = now * 屏幕宽
            transformCss(list,'translateX',-now * document.documentElement.clientWidth)
            //小圆点
            //1.统一给所有span元素添加 class = ''
            for (var i=0;i<spanNodes.length;i++) {
                spanNodes[i].className = ''
            };
            //2.切换到谁，谁对应的class = 'active'
            spanNodes[now%spanNodes.length].className = 'active'
            //开启定时器
				auto();

        });
        //自动轮播
			auto();
        function auto(){

            timer = setInterval(function(){
                //无缝
                if(now > 7){
                    now = 0;
                    //清除过渡
                    list.style.transition = 'none';
                    //真正的跳转动作
                    transformCss(list,'translateX',-now*document.documentElement.clientWidth)
                }

                setTimeout(function(){
                    now++;
                    //过渡
                    list.style.transition = '0.5s';
                    //写入
                    transformCss(list,'translateX',-now*document.documentElement.clientWidth)

                    //小圆点
                    //1.统一给所有span元素添加 class = ''
                    for (var i=0;i<spanNodes.length;i++) {
                        spanNodes[i].className = '';
                    };
                    //2.切换到谁，谁对应的class = 'active'
                    spanNodes[now%spanNodes.length].className = 'active'
                },20)

            },1000)

        }

    };
//  价钱拖拽
    function tuoJia() {
        <!--导航获取-->
        var navWrap = document.querySelector('#wrap .content .tuo_two');
        var navList = document.querySelector('#wrap .content .tuo_two .list_two');
//      定义元素初始位置
        var eleX = 0;
//      定义手指初始位置
        var startX = 0;
        //加速
        var s1 = 0;
        var t1 = 0;
        var s2 = 0;
        var t2 = 0;
        var disValue = 0;
        var disTime = 1; //非0数字
        var speed = 0;
        navWrap.addEventListener('touchstart',function (event) {
            var touch = event.changedTouches[0];
            navList.style.transition = 'none';
//            元素初始位置
            eleX = transformCss(navList,'translateX')
//            手指的初始位置
            startX = touch.clientX;
//            加速起始的位置
            s1 = eleX;
            t1 = new Date().getTime();
            speed = 0;
        });
        navWrap.addEventListener('touchmove',function (event) {
            var touch = event.changedTouches[0];
//            手指的结束位置
            var endX = touch.clientX;
//            手指距离差
            var disX = endX - startX;
            var translateX = disX+eleX;
            if(translateX > 0){
                translateX = 0;
            }else if(translateX < document.documentElement.clientWidth-navList.offsetWidth){
                translateX = document.documentElement.clientWidth-navList.offsetWidth;
            }
//            确定元素位置
            transformCss(navList,'translateX',translateX)
//            加速结束的位置
            s2 = translateX;
            t2 = new Date().getTime();
            disValue = s2 - s1;
            disTime = t2 - t1;
        })
//        加速
        navWrap.addEventListener('touchend',function () {
            speed = disValue / disTime;
            //元素最终位置 （加速） = touchmove 产生是位移值 + speed 产生的距离
            var target = transformCss(navList,'translateX') + speed*100;
            if(target > 0){
                target = 0;
            }else if(target < document.documentElement.clientWidth-navList.offsetWidth){
                target = document.documentElement.clientWidth-navList.offsetWidth;
            }
            navList.style.transition = '1s';
            transformCss(navList,'translateX',target);
        })
    }
    tuoJia();
</script>
</html>